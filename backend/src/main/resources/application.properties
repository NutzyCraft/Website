# Database Configuration (using environment variables)
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://ep-snowy-hat-a1duupft-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&prepareThreshold=5&preparedStatementCacheQueries=256&preparedStatementCacheSizeMiB=5}
spring.datasource.username=${DATABASE_USERNAME:neondb_owner}
spring.datasource.password=${DATABASE_PASSWORD}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
server.port=${PORT:8080}

# Spring Boot Optimization for Low Memory
spring.main.lazy-initialization=true
server.tomcat.threads.max=20
server.tomcat.threads.min-spare=5

# Logging Configuration
logging.level.org.apache.catalina.connector=ERROR
logging.level.org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver=ERROR

# Connection Pool Configuration (HikariCP) - Optimized for 512MB RAM
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA Performance Optimizations - Adjusted for low memory
spring.jpa.properties.hibernate.jdbc.batch_size=10
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.fetch_size=50
spring.jpa.properties.hibernate.query.timeout=10000
spring.jpa.properties.hibernate.generate_statistics=false

# Reduce connection timeout for faster failure detection
spring.datasource.hikari.connection-timeout=10000

# Flyway Configuration (disabled for existing database)
spring.flyway.enabled=false

# Email Configuration (Gmail SMTP)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME:nutzycraft@gmail.com}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# Application URL (for email links)
app.url=${APP_URL:http://localhost:8080}

# MongoDB Configuration
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.database=chat_db

# Contentful Configuration
contentful.space_id=${CONTENTFUL_SPACE_ID}
contentful.access_token=${CONTENTFUL_ACCESS_TOKEN}

# Static Resources Configuration
spring.web.resources.static-locations=file:///d:/Website/Frontend/
spring.mvc.static-path-pattern=/**
